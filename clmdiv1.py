#
#  File:
#    clmdiv1.py
#
#  Synopsis:
#    Draws U.S. geographic climate divisions as polygonal areas.
#
#  Categories:
#    maps only
#    polygons
#
#  Author:
#    Fred Clare (based on an NCL script of Mark Stevens, CGD, NCAR)
#  
#  Date of initial publication:
#    September, 2004
#
#  Description:
#    This example reads polygon data defining the U.S. geographic
#    climate divisions and produces a visualization of those divisions
#    colored randomly. 
#
#  Effects illustrated:
#      o  Using a Lambert conformal map projection.
#      o  How to select a map database resolution.
#      o  How to color only specified map areas.
#      o  How to draw color-filled polygons.
#      o  Usage of the the Python "random" module.
# 
#  Output:
#     A single visualization is produced showing the
#     U.S. climate divisions.
#

#
#  Import numpy and random.
#
from __future__ import print_function
import numpy
import random
import os

#
#  Import Nio for reading netCDF files.
#
import Nio

#
#  Import Ngl support functions.
#
import Ngl

#
#  Open the netCDF file containing the climate divisions polygons.
#
#dirc = Ngl.pynglpath("data")
ncdf = Nio.open_file("climdiv_polygons.nc")

#
#  State names for the contiguous U.S. states.
#
statenames = ["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN", \
              "IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT", \
              "NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA", \
              "RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"]

# 
#  Climate divisions in each state.
#
ncds = [8,7,9,7,5,3,
        2,6,9,10,9,9,
        9,9,4,9,3,8,
        3,10,9,10,6,7,
        8,4,2,3,8,10,
        8,9,10,9,9,10,
        1,7,9,4,10,7,
        3,6,10,6,9,10]

#
#  Number of polygons to draw.
#
npoly = len(ncds)

#
#  Define a color map and open a workstation.
#
cmap = numpy.array([[1.00,1.00,1.00],
                    [55,126,184],
                    [228,26,28],
                    [77,175,74],
                    [128,128,128],
                    [255,255,0],
                    [255,0,255],
                    [0,255,255]],
                    'f')/255
''' # nu=0.01
color_exp = [1,1,1,1,1,1,1,1,
             2,2,2,2,1,2,2,
             2,2,2,2,1,1,1,1,1,
             2,2,2,2,2,2,2,
             2,2,2,2,2,
             2,2,2,
             2,2,
             1,1,1,1,1,1,
             1,1,1,1,1,1,1,1,1,
             2,2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,
             1,1,1,1,1,1,1,1,1,
             2,2,2,
             2,2,2,2,2,2,2,2,
             2,2,2,
             2,2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             1,1,1,1,1,1,1,1,1,1,
             2,2,2,2,2,2,
             2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,
             2,2,2,2,
             2,2,
             2,2,2,
             2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,2,
             2,
             2,2,2,2,1,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,
             2,2,2,1,2,2,1,1,1,1,
             2,2,2,2,2,2,2,
             2,2,2,
             2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,
             2,2,2,2,2,2,2,2,2,2]
'''

# nu=0.10
# color_exp = [1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]

# nu=0.05
# color_exp = [1,1,1,1,1,1,1,1,1,2,2,2,1,1,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]

# nu=0.15
# color_exp = [1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1,1,2,2,2,2,2,2,1,1,2,2,2,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,2,2,2,2,2,1,1,1,1,2,1,2,1,1,2,2,2,1,1,2,1,1,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]

# nu=0.20
# color_exp = [1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,1,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,3,1,1,2,2,2,1,1,2,2,2,2,1,2,1,1,2,2,2,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,1,2,1,1,2,2,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,1,1,1,1,1,1,2,1,1,2,2,2,1,1,2,1,1,1,1,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]

# nu=0.25
# color_exp = [1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,3,1,2,2,3,3,3,3,3,3,3,3,1,1,1,1,3,3,3,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,1,1,1,1,1,1,1,3,3,3,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,1,3,3,3,1,1,3,3,3,3,1,3,1,1,3,3,3,1,3,3,3,3,3,3,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,1,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,3,2,2,3,3,1,1,3,3,3,2,3,3,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,3,3,3,2,3,3,3,1,1,1,1,1,1,3,1,1,1,3,3,1,1,2,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]

# nu=0.30
# color_exp = [2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,3,2,2,2,2,3,3,3,3,3,3,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,3,2,1,1,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,1,2,1,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,2,2,2,2,2,2,2,1,3,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,3,1,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,2,3,3,1,2,2,3,3,1,3,2,3,2,2,3,3,3,2,3,3,3,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,1,1,3,3,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,3,3,2,1,1,1,3,3,1,2,1,3,3,1,1,3,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,3,3,3,1,3,3,3,2,2,2,2,2,2,1,2,2,1,3,3,1,2,1,2,2,2,2,1,2,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]


# nu=0.40
# color_exp = [2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,3,2,2,2,2,3,1,3,3,3,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,2,1,1,3,1,1,3,3,1,1,1,1,2,2,2,1,3,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,1,2,2,2,2,2,1,1,1,3,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,2,3,3,1,2,1,3,3,1,3,1,1,2,2,3,3,3,1,1,3,3,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,1,1,3,1,1,1,1,1,2,1,1,2,2,2,2,2,2,2,2,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,1,1,1,3,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,1,1,1,3,1,3,3,3,2,2,2,1,1,2,1,1,1,1,3,3,1,1,1,1,1,1,2,1,2,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]


# nu=0.50
# color_exp = [2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,3,1,3,3,3,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,3,1,1,3,1,1,1,1,1,1,2,2,1,1,1,1,1,1,2,2,1,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,1,1,2,2,2,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,1,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,2,3,1,1,1,1,1,3,1,1,1,1,1,1,3,3,3,1,1,3,3,3,3,3,2,1,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,2,2,2,2,1,2,2,2,2,2,2,2,2,2,1,2,1,1,1,1,1,3,3,3,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,3,3,3,3,3,3,3,3,3,1,3,3,3,3,3,3,3,3,3,3]

# nu=0.60
# color_exp = [2,2,2,2,2,2,2,2,2,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,2,1,4,3,3,3,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,2,2,4,4,4,4,4,4,2,4,4,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,3,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,4,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,4,4,4,4,2,2,4,3,3,3,3,3,3,3,3,3,1,4,1,4,4,4,4,4,2,3,4,4,4,4,4,1,4,4,4,4,4,4,3,4,3,4,4,4,3,3,4,4,2,4,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,4,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,2,2,2,2,4,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,4,1,3,3,3,3,3,3,3,3,3]
# nu=0.70
# color_exp = [2,2,2,2,2,2,2,2,1,4,1,1,2,2,1,1,2,2,2,2,2,2,2,2,4,1,4,1,1,1,2,4,4,4,3,3,4,4,4,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,1,4,1,4,4,4,4,4,4,4,4,4,4,4,1,1,1,4,4,4,4,4,4,1,1,1,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,2,2,1,1,2,2,2,2,2,2,2,2,2,3,4,4,1,1,1,1,1,1,4,4,4,4,4,3,3,3,3,3,3,3,4,4,4,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,4,4,4,1,1,2,4,4,3,3,4,3,3,3,3,4,4,4,4,4,4,4,4,4,2,3,4,4,1,1,4,4,4,4,4,4,1,1,4,4,3,1,4,4,3,3,4,4,1,1,1,2,2,2,1,1,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,1,1,4,4,1,1,1,1,2,1,2,2,4,4,4,4,4,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,2,2,2,2,1,1,2,2,2,2,2,2,2,2,4,1,1,4,4,4,4,3,3,4,1,1,1,1,4,1,4,4,1,4,4,4,4,1,4,1,4,1,1,4,1,4,3,3,3,3,3,3,3,3,3,4,4,4,3,3,3,3,3,3,3,3]
# nu=0.80
# color_exp = [2,2,2,2,2,2,2,2,1,6,1,1,2,2,1,1,1,2,2,2,2,2,2,2,6,1,6,1,1,1,1,3,6,3,3,3,6,6,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,6,1,1,6,1,6,6,3,6,6,3,3,6,6,6,1,1,1,1,3,3,3,6,1,6,1,1,1,3,4,3,3,3,3,3,3,3,3,3,3,3,6,6,3,6,1,2,1,1,1,2,2,2,2,2,2,2,2,2,4,3,6,1,1,1,1,1,1,1,6,3,6,1,4,4,4,4,3,4,4,3,3,3,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,3,6,1,1,1,2,6,3,5,3,3,4,4,3,3,3,3,3,3,3,3,6,6,6,1,4,3,6,1,1,3,3,3,3,6,3,1,1,3,3,3,1,3,3,3,4,3,3,1,1,1,1,2,1,1,1,4,4,4,4,4,4,4,4,4,3,3,3,6,6,6,6,1,1,1,6,1,1,1,1,1,1,1,2,6,1,6,3,3,1,6,6,6,3,6,6,1,6,3,3,6,6,3,1,2,2,2,2,2,2,2,4,4,4,4,3,3,4,3,3,2,1,2,2,1,1,2,2,1,2,2,2,2,2,6,1,1,6,6,3,6,4,3,3,1,1,1,1,1,1,6,1,1,6,3,3,6,6,6,1,1,1,1,6,1,6,4,4,4,4,4,4,3,3,3,3,3,3,3,3,4,4,4,3,5,5]
# nu=0.90
color_exp = [3,3,3,3,3,3,3,3,1,5,7,7,3,1,1,1,1,3,1,3,3,3,3,3,5,7,6,7,7,7,1,2,6,2,2,2,6,5,7,7,7,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,6,7,7,6,7,7,7,6,6,6,6,6,5,5,5,5,7,1,1,6,6,6,5,5,5,1,1,7,2,2,2,2,2,6,6,6,6,6,6,5,6,5,5,5,5,5,1,1,1,1,3,3,3,3,3,3,3,3,3,2,6,6,5,5,5,5,7,7,5,5,6,5,7,4,4,4,4,2,2,2,6,2,2,4,4,4,4,4,4,2,2,2,3,3,3,3,3,3,3,3,3,3,6,5,5,5,1,1,6,6,2,2,2,4,2,2,2,2,6,6,2,6,6,7,7,7,1,2,6,5,7,7,6,6,5,6,5,6,5,5,6,6,2,7,6,6,2,2,6,6,1,5,1,1,1,1,1,1,4,4,4,4,4,4,2,4,4,6,6,6,5,5,5,5,7,7,5,5,5,5,5,1,1,1,1,1,5,7,5,6,6,7,6,7,7,6,6,5,5,5,6,6,5,5,6,7,1,3,1,1,3,3,1,2,2,4,2,2,2,2,2,2,1,1,1,1,5,1,1,3,1,1,3,3,3,3,7,1,7,6,6,6,7,2,2,6,1,1,5,5,5,7,5,7,7,5,6,6,7,7,7,7,7,7,1,5,7,5,4,4,4,4,4,2,2,2,2,6,6,2,2,2,2,2,2,2,2,2]
# nu=0.95
# color_exp = [1,1,5,5,5,5,5,5,2,6,10,10,1,1,2,2,1,1,1,1,5,1,5,5,4,10,3,10,2,2,2,3,6,3,9,3,6,6,4,10,10,5,5,5,5,5,5,1,1,1,5,5,5,5,5,1,6,11,11,6,11,11,11,3,6,6,3,3,6,6,6,10,10,2,2,6,6,6,4,4,4,2,2,10,9,9,9,3,3,3,3,7,6,4,4,4,4,4,4,4,4,10,1,1,2,2,5,5,5,5,5,5,5,5,5,9,3,6,10,10,10,10,10,10,10,6,3,6,4,8,9,9,8,3,9,9,3,3,3,8,8,8,9,9,8,9,9,9,5,5,1,5,5,5,5,5,5,5,6,4,10,10,2,1,6,3,9,9,3,9,9,9,9,3,3,3,3,7,7,11,11,11,1,9,6,6,10,10,3,3,4,3,4,6,10,10,3,3,9,10,6,3,3,9,3,3,2,10,2,1,1,1,2,2,8,8,8,9,8,8,9,9,8,6,6,6,6,4,6,6,10,10,10,4,10,10,10,10,1,10,1,1,4,10,6,6,3,11,6,11,11,3,6,4,4,6,3,6,6,6,3,4,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,1,1,1,1,10,10,1,5,1,1,5,5,5,5,11,2,11,6,6,3,6,9,9,3,10,10,10,10,10,10,6,11,10,4,3,3,11,11,6,11,10,10,10,4,10,4,8,8,8,9,9,9,9,9,9,3,3,3,9,9,9,9,9,3,9,9]



wks_type = "png"
wks = Ngl.open_wks (wks_type,"clmdiv1")

#
#  Create the plot.
#

#
#  Map resources.
#
res = Ngl.Resources()
res.mpLambertParallel1F = 33.0         # two parallels
res.mpLambertParallel2F = 45.0
res.mpLambertMeridianF  = -95.0        # central meridian

res.mpLimitMode         = "LatLon"     # limit map via lat/lon
res.mpMinLatF           = 24.0         # map area
res.mpMaxLatF           = 50.0         # latitudes
res.mpMinLonF           = -125.0       # and
res.mpMaxLonF           = -65.0        # longitudes

res.mpDataBaseVersion   = "Ncarg4_1"   # change database
res.mpFillOn            = True         # fill continents
res.mpPerimOn           = False        # no box around map

res.mpAreaMaskingOn        = True                 # draw only parts of map
res.mpFillAreaSpecifiers   = ["Water","Land"]     # what parts to fill
res.mpSpecifiedFillColors  = ["white","white"]   # fill with white
res.mpOutlineBoundarySets  = "USStates"           # what outlines to use
res.mpMaskAreaSpecifiers   = ["Conterminous US"]  # don't fill here
res.mpGridAndLimbOn        = False               # no lat/lon lines

#
#  Increase the viewport size (make the map bigger).
# 
res.vpWidthF  = 0.93
res.vpHeightF = 0.93
res.vpXF      = 0.05
res.vpYF      = 0.99
res.nglPaperWidth = 7.5
res.nglPaperHeight = 5.5
res.nglPaperMargin = 0

res.nglDraw  = False       # don't draw the plots now
res.nglFrame = False       # or advance the frame

res.mpProjection = "LambertConformal"
plot = Ngl.map(wks,res) # create the map plot

#
#  Polygon resources.
#
res_poly             = Ngl.Resources()
res_poly.gsEdgesOn   = True       # draw border around polygons.
res_poly.gsEdgeColor = "white"
res_poly.gsEdgeThicknessF = 1.5

#
# Prepare to draw the polygons.
#
random.seed(10)   # set a seed for the random number generator

#
#  Get the polygon data and fill polygons with random colors in 
#  the range of our color table (2-31).
#
t = 0
for st in range(npoly):
  for cd in range(ncds[st]):
    res_poly.gsFillColor = cmap[color_exp[t],:]
    t += 1
    varstr = "{}_CD{}".format(statenames[st], cd + 1)
    x = ncdf.variables[varstr].lon
    y = ncdf.variables[varstr].lat
    Ngl.polygon (wks,plot,x,y,res_poly)
    del(varstr)
    del(x)
    del(y)

#
# Add a title.
#
res_txt               = Ngl.Resources()         # text resources
res_txt.txFontHeightF = 0.03                    # select font size
res_txt.txFont        = "helvetica-bold"        # font
# Ngl.text_ndc (wks, "Climate Division Polygons", 0.5, 0.78, res_txt)

Ngl.frame(wks)

Ngl.end()
